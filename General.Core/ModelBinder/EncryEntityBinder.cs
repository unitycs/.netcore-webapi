using System;
using System.Threading.Tasks;
using Microsoft.AspNetCore.Http;
using Microsoft.AspNetCore.Mvc.ModelBinding;

namespace General.Core.ModelBinder
{
    /// <summary>
    /// 模型 加解密
    /// </summary>
    public class EncryEntityBinder : IModelBinder
    {
        /// <summary>
        /// BindModelAsync
        /// </summary>
        /// <param name="bindingContext"></param>
        /// <returns></returns>
        public Task BindModelAsync(ModelBindingContext bindingContext)
        {
            //var key = bindingContext.ModelName;
            //if (String.IsNullOrEmpty(key))
            //{
            //    key = bindingContext.FieldName;
            //}


            //string val = bindingContext.HttpContext.Request.Form[key];

            //if (String.IsNullOrEmpty(val))
            //{
            //    val = bindingContext.HttpContext.Request.Query[key];
            //}

            //if (String.IsNullOrEmpty(val))
            //{
            //    return Task.CompletedTask;
            //}
            //if (bindingContext.ModelType == typeof(string))
            //{
            //    bindingContext.Model = val;
            //}

            //if (bindingContext.ModelType == typeof(int))
            //{
            //    bindingContext.Model = int.Parse(val);
            //}

            //if (bindingContext.ModelType == typeof(long))
            //{
            //    bindingContext.Model = long.Parse(val);
            //}

            //if (bindingContext.ModelType == typeof(float))
            //{
            //    bindingContext.Model = float.Parse(val);
            //}

            //if (bindingContext.ModelType == typeof(double))
            //{
            //    bindingContext.Model = double.Parse(val);
            //}

            //if (bindingContext.ModelType == typeof(short))
            //{
            //    bindingContext.Model = short.Parse(val);
            //}

            //if (bindingContext.ModelType == typeof(DateTime))
            //{
            //    bindingContext.Model = DateTime.Parse(val);
            //}

            //if (bindingContext.Model != null)
            //{
            //    bindingContext.Result = ModelBindingResult.Success(bindingContext.Model);
            //}

            //if (bindingContext.ModelType == typeof(IFormFile))
            //{
            //    bindingContext.Model = bindingContext.HttpContext.Request.Form.Files[0];
            //}

            //bindingContext.Result = ModelBindingResult.Success(bindingContext.Model);
            return Task.CompletedTask;
        }
    }
}